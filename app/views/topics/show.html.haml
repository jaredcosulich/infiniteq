.col-sm-12
  = render 'topics/topic_path', topic: @topic
  .small.subtopics
    %strong Subtopics:
    &nbsp;
    - @topic.subtopics.most_questions.each do |subtopic|
      = link_to("#{subtopic.title} (#{subtopic.recursive_questions_count})", subtopic)
      &nbsp;&nbsp;
    = link_to "#{fa_icon('plus-circle')} New Subtopic".html_safe, new_topic_path(parent_topic_id: @topic.id)

  %h3.topic-title
    = @topic.title
    .description.small= markdown(@topic.description)

  .ask_a_question
    %h4 Ask A Question
    = form_for @question, html: {class: 'form-inline'} do |f|
      .form-group
        = f.text_field :text, class: 'form-control', placeholder: "Your Question about #{@topic.title}"
        = f.hidden_field :topic_id
        = f.submit 'Ask', class: 'btn btn-default'

  - if @topic.subtopics.present?
    .small.pull-right.filter
      = link_to_unless params[:f] == 't', 'Just This Topic', url_for(f: 't')
      &nbsp;|&nbsp;
      = link_to_if params[:f] == 't',  'Include Subtopics', url_for(f: nil)
  %h4 Questions

  - base_questions = (params[:f] == 't' ? @topic.questions : @topic.all_questions)
  %ul.nav.nav-tabs{role: 'tablist'}
    %li.active{role: 'presentation'}
      %a{href: '#verified', role: 'tab', aria: {controls: 'verified'}, data: {toggle: 'tab'}}
        Verified
        %span.label.label-success= base_questions.verified.count
    %li{role: 'presentation'}
      %a{href: '#unanswered', role: 'tab', aria: {controls: 'unanswered'}, data: {toggle: 'tab'}}
        Unanswered
        %span.label.label-danger= base_questions.verified.unanswered.count
    %li{role: 'presentation'}
      %a{href: '#unverified', role: 'tab', aria: {controls: 'unverified'}, data: {toggle: 'tab'}}
        Unverified
        %span.label.label-warning= base_questions.unverified.count
    %li{role: 'presentation'}
      %a{href: '#flagged', role: 'tab', aria: {controls: 'flagged'}, data: {toggle: 'tab'}}
        Flagged
        %span.label.label-default= base_questions.flagged.count
    %li{role: 'presentation'}
      %a{href: '#suspect', role: 'tab', aria: {controls: 'suspect'}, data: {toggle: 'tab'}}
        Suspect
        %span.label.label-default= base_questions.suspect.count

  .questions.tab-content
    .tab-pane.active{id: 'verified', role: 'tabpanel'}
      = render base_questions.verified
      - if base_questions.verified.empty?
        %h4.none No questions have been verified yet.
    .tab-pane{id: 'unanswered', role: 'tabpanel'}
      = render base_questions.verified.unanswered
      - if base_questions.verified.unanswered.empty?
        %h4.none There are currently no unanswered verified questions.
    .tab-pane{id: 'unverified', role: 'tabpanel'}
      = render base_questions.unverified
      - if base_questions.unverified.empty?
        %h4.none There are currently no unverified questions.
    .tab-pane{id: 'flagged', role: 'tabpanel'}
      = render base_questions.flagged
      - if base_questions.flagged.empty?
        %h4.none There are currently no flagged questions.
    .tab-pane{id: 'suspect', role: 'tabpanel'}
      = render base_questions.suspect
      - if base_questions.suspect.empty?
        %h4.none There are currently no suspect questions.
